<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ゲーム管理</title>
    <script src="https://bordgame.onrender.com/socket.io/socket.io.js"></script>
</head>
<body>
    <h1>ゲーム管理画面</h1>

    <h2>接続中のプレイヤー</h2>
    <ul id="playerList"></ul>

    <button id="startGame">🎮 ゲーム開始</button>
    <button id="endGame">🛑 ゲーム終了</button>
    <button id="resetuser">データベース初期化</button>

    <script>
        const socket = io("https://bordgame.onrender.com");

        // プレイヤー一覧を更新
        socket.on("updatePlayers", (players) => {
            const playerList = document.getElementById("playerList");
            playerList.innerHTML = "";
            players.forEach(player => {
                const li = document.createElement("li");
                li.textContent = `ID: ${player.id} - ${player.username}`;
                playerList.appendChild(li);
            });
        });

        // ゲーム開始ボタンを押す
        document.getElementById("startGame").addEventListener("click", () => {
            socket.emit("startGame");
        });

        // ゲーム終了ボタンを押す
        document.getElementById("endGame").addEventListener("click", () => {
            socket.emit("endGame");
        });
        
        document.getElementById("resetuser").addEventListener("click", function() {
            if (confirm("本当にデータベースを初期化しますか？")) {
                fetch("reset.php", {
                    method: "POST"
                })
                .then(response => response.text())
                .then(data => {
                    if (data.trim() === "success") {
                        alert("データベースが初期化されました。");
                    } else {
                        alert("エラーが発生しました: " + data);
                    }
                })
                .catch(error => console.error("エラー:", error));
            }
        });

    </script>
</body>
</html>
